{"ast":null,"code":"import _objectSpread from \"C:/Users/\\u0410\\u043D\\u0434\\u0440\\u0435\\u0439/Desktop/Vue 3 2021 \\u0412\\u043B\\u0430\\u0434\\u0438\\u043B\\u0435\\u043D \\u041C\\u0438\\u043D\\u0438\\u043D/014_2/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _regeneratorRuntime from \"C:/Users/\\u0410\\u043D\\u0434\\u0440\\u0435\\u0439/Desktop/Vue 3 2021 \\u0412\\u043B\\u0430\\u0434\\u0438\\u043B\\u0435\\u043D \\u041C\\u0438\\u043D\\u0438\\u043D/014_2/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/\\u0410\\u043D\\u0434\\u0440\\u0435\\u0439/Desktop/Vue 3 2021 \\u0412\\u043B\\u0430\\u0434\\u0438\\u043B\\u0435\\u043D \\u041C\\u0438\\u043D\\u0438\\u043D/014_2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ref, onMounted, computed } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRoute, useRouter } from 'vue-router';\nimport AppPage from '../components/ui/AppPage';\nimport AppLoader from '../components/ui/AppLoader';\nimport AppStatus from '../components/ui/AppStatus';\nimport { currency } from '../utils/currency';\nexport default {\n  setup: function setup() {\n    var route = useRoute();\n    var router = useRouter();\n    var store = useStore();\n    var status = ref();\n    var loading = ref(true);\n    var request = ref({});\n    onMounted( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      var _request$value;\n\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              loading.value = true;\n              _context.next = 3;\n              return store.dispatch('request/loadOne', route.params.id);\n\n            case 3:\n              request.value = _context.sent;\n              status.value = (_request$value = request.value) === null || _request$value === void 0 ? void 0 : _request$value.status;\n              loading.value = false;\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    })));\n    var hasChanges = computed(function () {\n      return request.value.status !== status.value;\n    });\n\n    var remove = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return store.dispatch('request/remove', route.params.id);\n\n              case 2:\n                router.push('/');\n\n              case 3:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function remove() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    var update = /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var data;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                data = _objectSpread(_objectSpread({}, request.value), {}, {\n                  status: status.value,\n                  id: route.params.id\n                });\n                _context3.next = 3;\n                return store.dispatch('request/update', data);\n\n              case 3:\n                request.value.status = status.value;\n\n              case 4:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      return function update() {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    return {\n      loading: loading,\n      request: request,\n      currency: currency,\n      remove: remove,\n      update: update,\n      status: status,\n      hasChanges: hasChanges\n    };\n  },\n  components: {\n    AppPage: AppPage,\n    AppLoader: AppLoader,\n    AppStatus: AppStatus\n  }\n};","map":{"version":3,"mappings":";;;AA2BA,SAAQA,GAAR,EAAaC,SAAb,EAAwBC,QAAxB,QAAuC,KAAvC;AACA,SAAQC,QAAR,QAAuB,MAAvB;AACA,SAAQC,QAAR,EAAkBC,SAAlB,QAAkC,YAAlC;AACA,OAAOC,OAAP,MAAoB,0BAApB;AACA,OAAOC,SAAP,MAAsB,4BAAtB;AACA,OAAOC,SAAP,MAAsB,4BAAtB;AACA,SAAQC,QAAR,QAAuB,mBAAvB;AAEA,eAAe;EACbC,KADa,mBACL;IACN,IAAMC,KAAI,GAAIP,QAAQ,EAAtB;IACA,IAAMQ,MAAK,GAAIP,SAAS,EAAxB;IACA,IAAMQ,KAAI,GAAIV,QAAQ,EAAtB;IACA,IAAMW,MAAK,GAAId,GAAG,EAAlB;IACA,IAAMe,OAAM,GAAIf,GAAG,CAAC,IAAD,CAAnB;IACA,IAAMgB,OAAM,GAAIhB,GAAG,CAAC,EAAD,CAAnB;IAEAC,SAAS,0EAAC;MAAA;;MAAA;QAAA;UAAA;YAAA;cACRc,OAAO,CAACE,KAAR,GAAgB,IAAhB;cADQ;cAAA,OAEcJ,KAAK,CAACK,QAAN,CAAe,iBAAf,EAAkCP,KAAK,CAACQ,MAAN,CAAaC,EAA/C,CAFd;;YAAA;cAERJ,OAAO,CAACC,KAFA;cAGRH,MAAM,CAACG,KAAP,qBAAeD,OAAO,CAACC,KAAvB,mDAAe,eAAeH,MAA9B;cACAC,OAAO,CAACE,KAAR,GAAgB,KAAhB;;YAJQ;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CAAD,GAAT;IAOA,IAAMI,UAAS,GAAInB,QAAQ,CAAC;MAAA,OAAMc,OAAO,CAACC,KAAR,CAAcH,MAAd,KAAyBA,MAAM,CAACG,KAAtC;IAAA,CAAD,CAA3B;;IAEA,IAAMK,MAAK;MAAA,uEAAI;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OACPT,KAAK,CAACK,QAAN,CAAe,gBAAf,EAAiCP,KAAK,CAACQ,MAAN,CAAaC,EAA9C,CADO;;cAAA;gBAEbR,MAAM,CAACW,IAAP,CAAY,GAAZ;;cAFa;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,CAAJ;;MAAA,gBAALD,MAAK;QAAA;MAAA;IAAA,GAAX;;IAKA,IAAME,MAAK;MAAA,uEAAI;QAAA;QAAA;UAAA;YAAA;cAAA;gBACPC,IADO,mCACIT,OAAO,CAACC,KADZ;kBACmBH,MAAM,EAAEA,MAAM,CAACG,KADlC;kBACyCG,EAAE,EAAET,KAAK,CAACQ,MAAN,CAAaC;gBAD1D;gBAAA;gBAAA,OAEPP,KAAK,CAACK,QAAN,CAAe,gBAAf,EAAiCO,IAAjC,CAFO;;cAAA;gBAGbT,OAAO,CAACC,KAAR,CAAcH,MAAd,GAAuBA,MAAM,CAACG,KAA9B;;cAHa;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,CAAJ;;MAAA,gBAALO,MAAK;QAAA;MAAA;IAAA,GAAX;;IAMA,OAAO;MAACT,OAAO,EAAPA,OAAD;MAAUC,OAAO,EAAPA,OAAV;MAAmBP,QAAQ,EAARA,QAAnB;MAA6Ba,MAAM,EAANA,MAA7B;MAAqCE,MAAM,EAANA,MAArC;MAA6CV,MAAM,EAANA,MAA7C;MAAqDO,UAAU,EAAVA;IAArD,CAAP;EACD,CA9BY;EA+BbK,UAAU,EAAE;IAACpB,OAAO,EAAPA,OAAD;IAAUC,SAAS,EAATA,SAAV;IAAqBC,SAAS,EAATA;EAArB;AA/BC,CAAf","names":["ref","onMounted","computed","useStore","useRoute","useRouter","AppPage","AppLoader","AppStatus","currency","setup","route","router","store","status","loading","request","value","dispatch","params","id","hasChanges","remove","push","update","data","components"],"sourceRoot":"","sources":["C:\\Users\\Андрей\\Desktop\\Vue 3 2021 Владилен Минин\\014_2\\src\\views\\Request.vue"],"sourcesContent":["<template>\n  <app-loader v-if=\"loading\"></app-loader>\n  <app-page back title=\"Заявка\" v-else-if=\"request\">\n    <p><strong>Имя владельца</strong>: {{request.fio}}</p>\n    <p><strong>Телефон</strong>: {{request.phone}}</p>\n    <p><strong>Сумма</strong>: {{currency(request.amount)}}</p>\n    <p><strong>Статус</strong>: <app-status :type=\"request.status\" /></p>\n\n    <div class=\"form-control\">\n      <label for=\"status\">Статус</label>\n      <select id=\"status\" v-model=\"status\">\n        <option value=\"done\">Завершен</option>\n        <option value=\"cancelled\">Отменен</option>\n        <option value=\"active\">Активен</option>\n        <option value=\"pending\">Выполняется</option>\n      </select>\n    </div>\n\n    <button class=\"btn danger\" @click=\"remove\">Удалить</button>\n    <button class=\"btn\" @click=\"update\" v-if=\"hasChanges\">Обновить</button>\n  </app-page>\n  <h3 v-else class=\"text-center text-white\">\n    Заявки с ID = {{$route.params.id}} нет.\n  </h3>\n</template>\n\n<script>\nimport {ref, onMounted, computed} from 'vue'\nimport {useStore} from 'vuex'\nimport {useRoute, useRouter} from 'vue-router'\nimport AppPage from '../components/ui/AppPage'\nimport AppLoader from '../components/ui/AppLoader'\nimport AppStatus from '../components/ui/AppStatus'\nimport {currency} from '../utils/currency'\n\nexport default {\n  setup() {\n    const route = useRoute()\n    const router = useRouter()\n    const store = useStore()\n    const status = ref()\n    const loading = ref(true)\n    const request = ref({})\n\n    onMounted(async () => {\n      loading.value = true\n      request.value = await store.dispatch('request/loadOne', route.params.id)\n      status.value = request.value?.status\n      loading.value = false\n    })\n\n    const hasChanges = computed(() => request.value.status !== status.value)\n\n    const remove = async () => {\n      await store.dispatch('request/remove', route.params.id)\n      router.push('/')\n    }\n\n    const update = async () => {\n      const data = {...request.value, status: status.value, id: route.params.id}\n      await store.dispatch('request/update', data)\n      request.value.status = status.value\n    }\n\n    return {loading, request, currency, remove, update, status, hasChanges}\n  },\n  components: {AppPage, AppLoader, AppStatus}\n}\n</script>\n\n<style scoped>\n\n</style>"]},"metadata":{},"sourceType":"module"}