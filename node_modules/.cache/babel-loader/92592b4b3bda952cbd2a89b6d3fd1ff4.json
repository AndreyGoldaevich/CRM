{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/\\u0410\\u043D\\u0434\\u0440\\u0435\\u0439/Desktop/Vue 3 2021 \\u0412\\u043B\\u0430\\u0434\\u0438\\u043B\\u0435\\u043D \\u041C\\u0438\\u043D\\u0438\\u043D/014_2/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/\\u0410\\u043D\\u0434\\u0440\\u0435\\u0439/Desktop/Vue 3 2021 \\u0412\\u043B\\u0430\\u0434\\u0438\\u043B\\u0435\\u043D \\u041C\\u0438\\u043D\\u0438\\u043D/014_2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.string.trim.js\";\nimport \"core-js/modules/web.timers.js\";\nimport { useField, useForm } from 'vee-validate';\nimport * as yup from 'yup';\nimport { computed, watch } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRouter } from 'vue-router';\nexport function useLoginForm() {\n  var store = useStore();\n  var router = useRouter();\n\n  var _useForm = useForm(),\n      handleSubmit = _useForm.handleSubmit,\n      isSubmitting = _useForm.isSubmitting,\n      submitCount = _useForm.submitCount;\n\n  var _useField = useField('email', yup.string().trim().required('Пожалуйста введите email').email('Необходимо ввести корректный email')),\n      email = _useField.value,\n      eError = _useField.errorMessage,\n      eBlur = _useField.handleBlur;\n\n  var MIN_LENGTH = 6;\n\n  var _useField2 = useField('password', yup.string().trim().required('Пожалуйста введите пароль').min(MIN_LENGTH, \"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C \\u043D\\u0435 \\u043C\\u043E\\u0436\\u0435\\u0442 \\u0431\\u044B\\u0442\\u044C \\u043C\\u0435\\u043D\\u044C\\u0448\\u0435 \".concat(MIN_LENGTH, \" \\u0441\\u0438\\u043C\\u0432\\u043E\\u043B\\u043E\\u0432\"))),\n      password = _useField2.value,\n      pError = _useField2.errorMessage,\n      pBlur = _useField2.handleBlur;\n\n  var isTooManyAttempts = computed(function () {\n    return submitCount.value >= 3;\n  });\n  watch(isTooManyAttempts, function (val) {\n    if (val) {\n      setTimeout(function () {\n        return submitCount.value = 0;\n      }, 1500);\n    }\n  });\n  var onSubmit = handleSubmit( /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(values) {\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return store.dispatch('auth/login', values);\n\n            case 3:\n              router.push('/');\n              _context.next = 8;\n              break;\n\n            case 6:\n              _context.prev = 6;\n              _context.t0 = _context[\"catch\"](0);\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 6]]);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }());\n  return {\n    email: email,\n    password: password,\n    eError: eError,\n    pError: pError,\n    eBlur: eBlur,\n    pBlur: pBlur,\n    onSubmit: onSubmit,\n    isSubmitting: isSubmitting,\n    isTooManyAttempts: isTooManyAttempts\n  };\n}","map":{"version":3,"names":["useField","useForm","yup","computed","watch","useStore","useRouter","useLoginForm","store","router","handleSubmit","isSubmitting","submitCount","string","trim","required","email","value","eError","errorMessage","eBlur","handleBlur","MIN_LENGTH","min","password","pError","pBlur","isTooManyAttempts","val","setTimeout","onSubmit","values","dispatch","push"],"sources":["C:/Users/Андрей/Desktop/Vue 3 2021 Владилен Минин/014_2/src/use/login-form.js"],"sourcesContent":["import {useField, useForm} from 'vee-validate'\nimport * as yup from 'yup'\nimport {computed, watch} from 'vue'\nimport {useStore} from 'vuex'\nimport {useRouter} from 'vue-router'\n\nexport function useLoginForm() {\n  const store = useStore()\n  const router = useRouter()\n  const {handleSubmit, isSubmitting, submitCount} = useForm()\n\n  const {value: email, errorMessage: eError, handleBlur: eBlur} = useField(\n    'email',\n    yup\n      .string()\n      .trim()\n      .required('Пожалуйста введите email')\n      .email('Необходимо ввести корректный email')\n  )\n\n  const MIN_LENGTH = 6\n\n  const {value: password, errorMessage: pError, handleBlur: pBlur} = useField(\n    'password',\n    yup\n      .string()\n      .trim()\n      .required('Пожалуйста введите пароль')\n      .min(MIN_LENGTH, `Пароль не может быть меньше ${MIN_LENGTH} символов`)\n  )\n\n  const isTooManyAttempts = computed(() => submitCount.value >= 3)\n\n  watch(isTooManyAttempts, val => {\n    if (val) {\n      setTimeout(() => submitCount.value = 0, 1500)\n    }\n  })\n\n  const onSubmit = handleSubmit(async values => {\n    try {\n      await store.dispatch('auth/login', values)\n      router.push('/')\n    } catch (e) {\n    }\n  })\n\n  return {\n    email,\n    password,\n    eError,\n    pError,\n    eBlur,\n    pBlur,\n    onSubmit,\n    isSubmitting,\n    isTooManyAttempts\n  }\n}"],"mappings":";;;;AAAA,SAAQA,QAAR,EAAkBC,OAAlB,QAAgC,cAAhC;AACA,OAAO,KAAKC,GAAZ,MAAqB,KAArB;AACA,SAAQC,QAAR,EAAkBC,KAAlB,QAA8B,KAA9B;AACA,SAAQC,QAAR,QAAuB,MAAvB;AACA,SAAQC,SAAR,QAAwB,YAAxB;AAEA,OAAO,SAASC,YAAT,GAAwB;EAC7B,IAAMC,KAAK,GAAGH,QAAQ,EAAtB;EACA,IAAMI,MAAM,GAAGH,SAAS,EAAxB;;EACA,eAAkDL,OAAO,EAAzD;EAAA,IAAOS,YAAP,YAAOA,YAAP;EAAA,IAAqBC,YAArB,YAAqBA,YAArB;EAAA,IAAmCC,WAAnC,YAAmCA,WAAnC;;EAEA,gBAAgEZ,QAAQ,CACtE,OADsE,EAEtEE,GAAG,CACAW,MADH,GAEGC,IAFH,GAGGC,QAHH,CAGY,0BAHZ,EAIGC,KAJH,CAIS,oCAJT,CAFsE,CAAxE;EAAA,IAAcA,KAAd,aAAOC,KAAP;EAAA,IAAmCC,MAAnC,aAAqBC,YAArB;EAAA,IAAuDC,KAAvD,aAA2CC,UAA3C;;EASA,IAAMC,UAAU,GAAG,CAAnB;;EAEA,iBAAmEtB,QAAQ,CACzE,UADyE,EAEzEE,GAAG,CACAW,MADH,GAEGC,IAFH,GAGGC,QAHH,CAGY,2BAHZ,EAIGQ,GAJH,CAIOD,UAJP,2JAIkDA,UAJlD,uDAFyE,CAA3E;EAAA,IAAcE,QAAd,cAAOP,KAAP;EAAA,IAAsCQ,MAAtC,cAAwBN,YAAxB;EAAA,IAA0DO,KAA1D,cAA8CL,UAA9C;;EASA,IAAMM,iBAAiB,GAAGxB,QAAQ,CAAC;IAAA,OAAMS,WAAW,CAACK,KAAZ,IAAqB,CAA3B;EAAA,CAAD,CAAlC;EAEAb,KAAK,CAACuB,iBAAD,EAAoB,UAAAC,GAAG,EAAI;IAC9B,IAAIA,GAAJ,EAAS;MACPC,UAAU,CAAC;QAAA,OAAMjB,WAAW,CAACK,KAAZ,GAAoB,CAA1B;MAAA,CAAD,EAA8B,IAA9B,CAAV;IACD;EACF,CAJI,CAAL;EAMA,IAAMa,QAAQ,GAAGpB,YAAY;IAAA,sEAAC,iBAAMqB,MAAN;MAAA;QAAA;UAAA;YAAA;cAAA;cAAA;cAAA,OAEpBvB,KAAK,CAACwB,QAAN,CAAe,YAAf,EAA6BD,MAA7B,CAFoB;;YAAA;cAG1BtB,MAAM,CAACwB,IAAP,CAAY,GAAZ;cAH0B;cAAA;;YAAA;cAAA;cAAA;;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CAAD;;IAAA;MAAA;IAAA;EAAA,IAA7B;EAQA,OAAO;IACLjB,KAAK,EAALA,KADK;IAELQ,QAAQ,EAARA,QAFK;IAGLN,MAAM,EAANA,MAHK;IAILO,MAAM,EAANA,MAJK;IAKLL,KAAK,EAALA,KALK;IAMLM,KAAK,EAALA,KANK;IAOLI,QAAQ,EAARA,QAPK;IAQLnB,YAAY,EAAZA,YARK;IASLgB,iBAAiB,EAAjBA;EATK,CAAP;AAWD"},"metadata":{},"sourceType":"module"}